<div class="container-fluid h-100">
    <script type="text/javascript" src="https://jstest.authorize.net/v3/AcceptUI.js" charset="utf-8">
    </script>

    <h4>Payment Form - Pop Up Option</h4>
    <hr>

    <button type="button" class="AcceptUI btn btn-success" data-billingAddressOptions='{"show":true, "required":true}'
            data-apiLoginID="{{ client['login'] }}" data-clientKey="{{ client['key'] }}" data-acceptUIFormBtnTxt="Add Payment Method"
            data-acceptUIFormHeaderTxt="Card Information" data-responseHandler="responseHandler">
        Add Payment Method
    </button>

    <textarea id="payment_response" class="form-control h-100 mt-2" placeholder="Leave a comment here" readonly>Use the Hosted Add Payment Method button above to get a Opaque Payment Data object</textarea>
    
    <script>
        function responseHandler(response) {
            if (response.messages.resultCode === "Error") {
                var i = 0;
                while (i < response.messages.message.length) {
                    console.log(
                        response.messages.message[i].code + ": " +
                        response.messages.message[i].text
                    );
                    i = i + 1;
                }
            } else {
                let formatted = JSON.stringify(response,null,2)
                
                text_area = document.getElementById("payment_response")
                text_area.removeAttribute("readonly")
                text_area.value = formatted
                text_area.setAttribute("readonly", "")
            }
        }
    </script>
</div>